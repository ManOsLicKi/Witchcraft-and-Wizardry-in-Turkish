execute at @s[scores={darkSpiritDelay=0..7},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:23}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:23,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=8..14},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:12}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:12,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=15..21},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:11}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:11,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=22..28},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:10}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:10,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=29..35},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:9}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:9,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=36..42},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:8}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:8,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=43..49},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:7}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:7,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=50..56},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:6}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:6,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=57..63},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:5}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:5,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=64..70},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:4}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:4,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=71..77},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:3}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:3,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=78..84},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:2}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:2,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=85..91},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:1}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:1,qDetect:1b,fDetect:1b}
execute at @s[scores={darkSpiritDelay=92..},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:0}}]}] run replaceitem entity @s weapon.offhand minecraft:carrot_on_a_stick{Unbreakable:1,Damage:0,qDetect:1b,fDetect:1b}

# If the screen is fairly bright show damage overlay instead
# replaceitem entity @s[scores={darkSpiritDelay=0..14,damageOverlay=2},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:17}}]}] weapon.offhand minecraft:carrot_on_a_stick{display:{Name:"{\"text\":\" \",\"color\":\"gold\",\"bold\":true}"},HideFlags:63,Damage:17,Unbreakable:1b,qDetect:1b,fDetect:1b}
# replaceitem entity @s[scores={darkSpiritDelay=0..21,damageOverlay=3},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:17}}]}] weapon.offhand minecraft:carrot_on_a_stick{display:{Name:"{\"text\":\" \",\"color\":\"gold\",\"bold\":true}"},HideFlags:63,Damage:17,Unbreakable:1b,qDetect:1b,fDetect:1b}
# replaceitem entity @s[scores={darkSpiritDelay=0..28,damageOverlay=4},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:18}}]}] weapon.offhand minecraft:carrot_on_a_stick{display:{Name:"{\"text\":\" \",\"color\":\"gold\",\"bold\":true}"},HideFlags:63,Damage:18,Unbreakable:1b,qDetect:1b,fDetect:1b}
# replaceitem entity @s[scores={darkSpiritDelay=0..35,damageOverlay=5},nbt=!{Inventory:[{Slot:-106b,id:"minecraft:carrot_on_a_stick",tag:{Damage:19}}]}] weapon.offhand minecraft:carrot_on_a_stick{display:{Name:"{\"text\":\" \",\"color\":\"gold\",\"bold\":true}"},HideFlags:63,Damage:19,Unbreakable:1b,qDetect:1b,fDetect:1b}


# Delay it slightly so there's a nice fade in as well as a fade out
execute as @s[scores={darkSpiritStun=1..},tag=offhandCanBeReplaced] run scoreboard players operation @s tmp = @s darkSpiritDelay
execute as @s[scores={darkSpiritStun=1..},tag=offhandCanBeReplaced] run scoreboard players operation @s tmp -= @s darkSpiritStun
execute as @s[scores={darkSpiritStun=1..},tag=offhandCanBeReplaced] run scoreboard players set @s tmp2 4
execute as @s[scores={darkSpiritStun=1..},tag=offhandCanBeReplaced] run scoreboard players operation @s tmp /= @s tmp2
execute as @s[scores={darkSpiritStun=1..},tag=offhandCanBeReplaced] run scoreboard players operation @s darkSpiritDelay -= @s tmp